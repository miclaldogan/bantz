# Bantz Permission Policy — default rules (Issue #452)
#
# First matching rule wins.  Use wildcards (* / ?) for tool and action patterns.
# Decisions: allow | confirm | deny
# Conditions: max_per_day, max_per_session

permissions:
  # ── Read operations ────────────────────────────────────────
  - tool: "calendar.list_events"
    action: "read"
    risk: "low"
    decision: "allow"

  - tool: "gmail.read"
    action: "read"
    risk: "low"
    decision: "allow"

  # ── Calendar write ─────────────────────────────────────────
  - tool: "calendar.create_event"
    action: "write"
    risk: "medium"
    decision: "confirm"
    conditions:
      max_per_day: 20

  - tool: "calendar.update_event"
    action: "write"
    risk: "medium"
    decision: "confirm"

  - tool: "calendar.delete_event"
    action: "delete"
    risk: "high"
    decision: "confirm"
    conditions:
      max_per_day: 5

  # ── Gmail write ────────────────────────────────────────────
  - tool: "gmail.send"
    action: "write"
    risk: "high"
    decision: "confirm"
    conditions:
      max_per_day: 50
      max_per_session: 10

  # ── File system ────────────────────────────────────────────
  - tool: "file.*"
    action: "write"
    risk: "medium"
    decision: "confirm"

  # ── System commands ────────────────────────────────────────
  - tool: "system.execute_command"
    action: "execute"
    risk: "critical"
    decision: "deny"

  - tool: "system.*"
    action: "execute"
    risk: "critical"
    decision: "deny"

  # ── Browser (Issue #856) ───────────────────────────────────
  - tool: "browser.info"
    action: "read"
    risk: "low"
    decision: "allow"

  - tool: "browser.scan"
    action: "read"
    risk: "low"
    decision: "allow"

  - tool: "browser.click"
    action: "execute"
    risk: "medium"
    decision: "confirm"

  - tool: "browser.type"
    action: "execute"
    risk: "medium"
    decision: "confirm"

  - tool: "browser.submit_form"
    action: "execute"
    risk: "high"
    decision: "confirm"

  - tool: "browser.*"
    action: "execute"
    risk: "medium"
    decision: "confirm"

  # ── PC / input (Issue #856) ────────────────────────────────
  - tool: "pc.mouse_move"
    action: "execute"
    risk: "low"
    decision: "allow"

  - tool: "pc.hotkey"
    action: "execute"
    risk: "medium"
    decision: "confirm"

  - tool: "pc.*"
    action: "execute"
    risk: "medium"
    decision: "confirm"

  # ── Clipboard (Issue #856) ─────────────────────────────────
  - tool: "clipboard.get"
    action: "read"
    risk: "low"
    decision: "allow"

  - tool: "clipboard.set"
    action: "write"
    risk: "medium"
    decision: "confirm"

  # ── Google Suite Connectors (Issue #1292) ───────────────────
  - tool: "google.contacts.search"
    action: "read"
    risk: "low"
    decision: "allow"

  - tool: "google.contacts.get"
    action: "read"
    risk: "low"
    decision: "allow"

  - tool: "google.contacts.create"
    action: "write"
    risk: "medium"
    decision: "confirm"

  - tool: "google.tasks.list"
    action: "read"
    risk: "low"
    decision: "allow"

  - tool: "google.tasks.create"
    action: "write"
    risk: "medium"
    decision: "confirm"
    conditions:
      max_per_day: 30

  - tool: "google.tasks.complete"
    action: "write"
    risk: "medium"
    decision: "confirm"

  - tool: "google.tasks.delete"
    action: "delete"
    risk: "high"
    decision: "confirm"
    conditions:
      max_per_day: 10

  - tool: "google.keep.*"
    action: "read"
    risk: "low"
    decision: "allow"

  - tool: "google.keep.create"
    action: "write"
    risk: "medium"
    decision: "confirm"

  - tool: "google.classroom.*"
    action: "read"
    risk: "low"
    decision: "allow"

  # ── Proactive Secretary (Issue #1293) ──────────────────────
  - tool: "proactive.daily_brief"
    action: "read"
    risk: "low"
    decision: "allow"

  - tool: "proactive.status"
    action: "read"
    risk: "low"
    decision: "allow"

  # ── Catch-all (unknown tools) ──────────────────────────────
  - tool: "*"
    action: "*"
    risk: "medium"
    decision: "confirm"


# ── Redact Fields (Issue #1291) ──────────────────────────────
# Per-tool sensitive parameter fields to mask in confirmation UI.
# Global keys (password, api_key, token, secret, etc.) are ALWAYS
# redacted regardless of this config.

redact_fields:
  gmail.send:
    - password
    - api_key
    - token
    - refresh_token
  gmail.send_draft:
    - password
    - token
  gmail.send_to_contact:
    - password
    - token
  system.execute_command:
    - env_vars
    - environment
  calendar.create_event: []
  calendar.update_event: []
  calendar.delete_event: []
  "browser.*":
    - cookie
    - authorization


# ── Editable Fields (Issue #1291) ────────────────────────────
# Per-tool fields that users may edit before confirming (HIGH risk only).
# Fields listed here appear as "[DÜZENLENEBİLİR]" in the confirmation UI.

editable_fields:
  calendar.delete_event:
    - notify_attendees
  calendar.create_event:
    - title
    - description
    - start_time
    - end_time
    - attendees
  calendar.update_event:
    - title
    - description
    - start_time
    - end_time
    - attendees
  gmail.send:
    - subject
    - body
    - to
    - cc
    - bcc
  gmail.send_to_contact:
    - subject
    - body
  gmail.send_draft:
    - subject
    - body
  system.execute_command:
    - command
