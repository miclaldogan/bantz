# Bantz Permission Policy — default rules (Issue #452)
#
# First matching rule wins.  Use wildcards (* / ?) for tool and action patterns.
# Decisions: allow | confirm | deny
# Conditions: max_per_day, max_per_session

permissions:
  # ── Read operations ────────────────────────────────────────
  - tool: "calendar.list_events"
    action: "read"
    risk: "low"
    decision: "allow"

  - tool: "gmail.read"
    action: "read"
    risk: "low"
    decision: "allow"

  # ── Calendar write ─────────────────────────────────────────
  - tool: "calendar.create_event"
    action: "write"
    risk: "medium"
    decision: "confirm"
    conditions:
      max_per_day: 20

  - tool: "calendar.update_event"
    action: "write"
    risk: "medium"
    decision: "confirm"

  - tool: "calendar.delete_event"
    action: "delete"
    risk: "high"
    decision: "confirm"
    conditions:
      max_per_day: 5

  # ── Gmail write ────────────────────────────────────────────
  - tool: "gmail.send"
    action: "write"
    risk: "high"
    decision: "confirm"
    conditions:
      max_per_day: 50
      max_per_session: 10

  # ── File system ────────────────────────────────────────────
  - tool: "file.*"
    action: "write"
    risk: "medium"
    decision: "confirm"

  # ── System commands ────────────────────────────────────────
  - tool: "system.execute_command"
    action: "execute"
    risk: "critical"
    decision: "deny"

  - tool: "system.*"
    action: "execute"
    risk: "critical"
    decision: "deny"

  # ── Browser (Issue #856) ───────────────────────────────────
  - tool: "browser.info"
    action: "read"
    risk: "low"
    decision: "allow"

  - tool: "browser.scan"
    action: "read"
    risk: "low"
    decision: "allow"

  - tool: "browser.click"
    action: "execute"
    risk: "medium"
    decision: "confirm"

  - tool: "browser.type"
    action: "execute"
    risk: "medium"
    decision: "confirm"

  - tool: "browser.submit_form"
    action: "execute"
    risk: "high"
    decision: "confirm"

  - tool: "browser.*"
    action: "execute"
    risk: "medium"
    decision: "confirm"

  # ── PC / input (Issue #856) ────────────────────────────────
  - tool: "pc.mouse_move"
    action: "execute"
    risk: "low"
    decision: "allow"

  - tool: "pc.hotkey"
    action: "execute"
    risk: "medium"
    decision: "confirm"

  - tool: "pc.*"
    action: "execute"
    risk: "medium"
    decision: "confirm"

  # ── Clipboard (Issue #856) ─────────────────────────────────
  - tool: "clipboard.get"
    action: "read"
    risk: "low"
    decision: "allow"

  - tool: "clipboard.set"
    action: "write"
    risk: "medium"
    decision: "confirm"

  # ── Catch-all (unknown tools) ──────────────────────────────
  - tool: "*"
    action: "*"
    risk: "medium"
    decision: "confirm"
