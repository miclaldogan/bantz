# CodeRabbit Configuration
# Docs: https://docs.coderabbit.ai/guides/configure-coderabbit
# Install: https://github.com/marketplace/coderabbitai

language: "tr"  # Review dilini TÃ¼rkÃ§e yap (Ä°ngilizce istersen "en" yap)

reviews:
  # Her PR'da otomatik review baÅŸlat
  auto_review:
    enabled: true
    # Draft PR'larÄ± inceleme, sadece ready olanlarÄ±
    drafts: false
    # Base branch'ler â€” sadece dev ve main'e aÃ§Ä±lan PR'larÄ± incele
    base_branches:
      - "dev"
      - "main"
      - "master"

  # Review profili â€” assertive = daha detaylÄ±, chill = sadece Ã¶nemli ÅŸeyler
  profile: "assertive"

  # YÃ¼ksek dÃ¼zey Ã¶zet oluÅŸtur
  high_level_summary: true
  # PR aÃ§Ä±klamasÄ±na summary ekle
  auto_title_placeholder: "[CodeRabbit]"

  # Poem (ÅŸiir) eklemesin ğŸ˜„
  poem: false

  # Review scope â€” nelere baksÄ±n
  request_changes_workflow: true
  collapse_walkthrough: false
  sequence_diagrams: true

  # Path filtreleri â€” bunlarÄ± incelemesin
  path_filters:
    - "!artifacts/**"
    - "!docs/benchmarks/**"
    - "!**/*.png"
    - "!**/*.svg"
    - "!**/*.jpg"
    - "!**/*.ico"
    - "!**/package-lock.json"
    - "!**/yarn.lock"

  # Path-specific instructions
  path_instructions:
    - path: "src/bantz/brain/**"
      instructions: |
        Bu dizin Bantz'Ä±n beyin katmanÄ±dÄ±r (orchestrator, router, finalizer).
        - Thread-safety kritik: threading.Lock kullanÄ±mÄ±nÄ± kontrol et
        - TÃ¼m LLM Ã§aÄŸrÄ±larÄ± try/except ile sarÄ±lmalÄ±
        - orchestrator_loop.py deÄŸiÅŸikliklerinde dikkatli ol, production kodu
    - path: "src/bantz/data/**"
      instructions: |
        Data platform katmanÄ±. SQLite-backed, WAL journal mode.
        - Thread-safety kontrol et (self._lock kullanÄ±mÄ±)
        - TTL ve expires_at hesaplamalarÄ±nÄ± doÄŸrula
        - Fingerprint hesaplamalarÄ± deterministic olmalÄ± (sort_keys=True)
    - path: "src/bantz/skills/**"
      instructions: |
        Tool/skill modÃ¼lleri. Her skill bir tool_schema dÃ¶ner.
        - Google API rate limit handling kontrol et
        - Credential/token bilgileri hardcoded olmamalÄ±
        - Her public fonksiyon docstring'e sahip olmalÄ±
    - path: "tests/**"
      instructions: |
        Test dosyalarÄ±. pytest + pytest-asyncio kullanÄ±lÄ±yor.
        - Mock'lar doÄŸru scope'da olmalÄ± (function/class/module)
        - Async testler @pytest.mark.asyncio ile iÅŸaretlenmeli
        - Flaky test riski varsa belirt
    - path: "config/**"
      instructions: |
        KonfigÃ¼rasyon dosyalarÄ±. Hassas bilgi iÃ§ermemeli.
        - Secrets/tokens/passwords olmamalÄ±
        - Example dosyalar (.example) gÃ¼ncel olmalÄ±

chat:
  auto_reply: true

# Ã–ÄŸrenme â€” reviewer feedback'inden Ã¶ÄŸrensin
knowledge_base:
  learnings:
    scope: "auto"       # PR'lardaki ğŸ‘/ğŸ‘'den Ã¶ÄŸren
  jira:
    project_keys: []    # Jira kullanmÄ±yoruz ÅŸu an
  linear:
    team_keys: []       # Linear kullanmÄ±yoruz ÅŸu an

# Tonalite
tone_instructions: |
  TÃ¼rkÃ§e review yap. KÄ±sa ve net ol.
  Kritik bug/security bulduÄŸunda "ğŸš¨ KRÄ°TÄ°K:" prefix'i kullan.
  KÃ¼Ã§Ã¼k stil Ã¶nerileri iÃ§in "ğŸ’¡ Ã–neri:" prefix'i kullan.
  Her review'un sonunda "Genel DeÄŸerlendirme: âœ…/âš ï¸/âŒ" ver.
